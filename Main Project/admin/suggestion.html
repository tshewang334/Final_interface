<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>suggestionback Interface</title>
  <style>
    body {
      font-family: Arial, Helvetica, sans-serif;
      background: #fff;
      margin: 0;
      padding: 0;
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .container {
      width: 100%;
      height: 100vh;
      border: 1px solid #ddd;
      border-radius: 16px;
      display: flex;
      flex-direction: column;
      overflow: hidden; 
      box-shadow: 0 6px 18px rgba(0,0,0,0.08);
      background: #fff;
    }

    /* Header */
    .header {
      display: flex;
      align-items: center;
      padding: 12px;
      background: #d6d6d6;
      border-bottom: 1px solid #e6e6e6;
      gap: 12px;
      height: 20vh;
      justify-content: center;
      position: relative;
    }

    .back-btn {
      font-size: 20px;
      cursor: pointer;
      user-select: none;
    }

    .title { 
      font-size: 14px; 
      font-weight: 700; 
      color: #000000;
      width: 100%;
      /* margin-left: 30%; */
      height: 5vh;
      margin-top: 15px;
      font-weight: bold;
      font-size: larger;
    }

    /* Buttons */
    .buttons {
      padding: 10px;
      border-bottom: 1px solid #eee;
      background: #fafafa;
    }

    .btn {
      display: inline-block;
      background: #e9e9e9;
      border: none;
      border-radius: 6px;
      padding: 8px 10px;
      margin: 6px 6px 6px 0;
      cursor: pointer;
      font-size: 13px;
    }

    .section-title {
      padding: 10px;
      background: #f7f7f7;
      border-bottom: 1px solid #eee;
      font-weight: 700;
    }

    /* Chat scrollable area */
    .chat-box {
      flex-grow: 1;
      padding: 14px;
      overflow-y: auto; /* THIS is the only scrollable area */
      background: #ffffff;
      /* max-width: 420px; */
    }

    /* Message styles */
    .message {
      display: flex;
      align-items: flex-start;
      margin-bottom: 14px;
      gap: 10px;
    }

    .avatar {
      width: 34px;
      height: 34px;
      border-radius: 50%;
      background: #dedede;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
      color: #444;
      flex-shrink: 0;
    }

    .bubble {
      background: #e6e6e6;
      padding: 10px 14px;
      border-radius: 18px;
      max-width: 92%;
      cursor: pointer;
      user-select: text;
      text-decoration: none;
      color: #333;
    }

    .voice {
      background: #2f78d2;
      color: white;
      padding: 10px 18px;
      border-radius: 18px;
      max-width: 52%;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      user-select: none;
      gap: 8px;
      /* max-width: 30%; */
    }
    .voice:focus { outline: 2px solid rgba(47,120,210,0.3); }
    .voice:hover { background: #2765b0; }

    /* small play icon */
    .play-icon {
      display: inline-block;
      width: 12px;
      height: 12px;
      border-left: 10px solid white;
      border-top: 6px solid transparent;
      border-bottom: 6px solid transparent;
    }

    /* tiny timestamp or label */
    .label { font-size: 11px; color: #fff; opacity: .9; }

  </style>
</head>
<body>

<div class="container" aria-label="Suggestions container">
  <!-- Header -->
  <div class="header">
    <span class="back-btn" onclick="goBack()" role="button" aria-label="Go back">‚Üê</span>
    <span class="title">EVENT 6 (Financial Literacy)</span>
  </div>

  <!-- Buttons -->
  <div class="buttons">
    <!-- <a href="" onclick="goToEventDescription()" class="btn"> EVENT DESCRIPTION</a> -->
    <button class="btn" onclick="goToEventDescription()">EVENT DESCRIPTION</button>
    <button class="btn" id="totalSuggestionsBtn" onclick="showTotalSuggestions()">TOTAL SUGGESTION</button> 
  </div>

  <!-- Section Title -->
  <div class="section-title">SUGGESTION DETAILS
    
  </div>

  <!-- Chat Section (only this part scrolls) -->
  <div class="chat-box" id="chatBox">
    <!-- Example of many Suggestions items (text + voice) -->
    <div class="message">
      <div class="avatar">üë§</div>
      <!-- <div class="bubble" onclick="openSuggestions('Text Suggestions 1')">
        Suggestions provided by citizen in text format (1)</div> -->
        <a href="../admin/clicksugg.html" class="bubble">Lorem ipsum dolor, sit amet consectetur adipisicing elit. Sapiente, explicabo debitis. Excepturi distinctio dolorem officia, eos repudiandae iure? Dolore, fugit doloremque harum quidem neque laudantium qui voluptatum nam voluptatibus minus?</a>
    </div>

    <div class="message">
      <div class="avatar">üë§</div>
      <!-- voice button now holds data-src and passes itself to playVoice -->
      <div class="voice" role="button" tabindex="0" data-src="voice1.mp3"
           onclick="playVoice(this)" onkeydown="handleKeyPress(event,this)">
        <span class="play-icon" aria-hidden="true"></span>
        <span class="label">Voice Suggestions (1)</span>
      </div>
      <!-- optional fallback audio element (not required) -->
      <audio id="voice1" src="voice1.mp3" preload="none"><a href="../admin/clickSuggestions.html" class="bubble"></a></audio>
    </div>

    <div class="message">
      <div class="avatar">üë§</div>
      <div class="bubble" onclick="openSuggestions('Text Suggestions 2')">
        Suggestions provided by citizen in text format (2)
      </div>
    </div>

    <div class="message">
      <div class="avatar">üë§</div>
      <div class="voice" role="button" tabindex="0" data-src="voice2.mp3"
           onclick="playVoice(this)" onkeydown="handleKeyPress(event,this)">
        <span class="play-icon" aria-hidden="true"></span>
        <span class="label">Voice Suggestions (2)</span>
      </div>
      <audio id="voice2" src="voice2.mp3" preload="none"></audio>
    </div>

    <!-- Add many more text items so scrolling is visible -->
    <!-- Text-only items -->
    <div class="message"><div class="avatar">üë§</div><div class="bubble">Suggestions (3) ;Lorem ipsum dolor sit, amet consectetur adipisicing elit. Culpa doloribus quis maiores soluta temporibus consequuntur consequatur officia ullam! Libero quam maxime id tempora molestias error, nihil iusto alias odit cumque.</div></div>
    <div class="message"><div class="avatar">üë§</div><div class="bubble">Suggestions (4) Lorem ipsum dolor sit amet consectetur adipisicing elit. Cupiditate cumque asperiores tempora quam, impedit repellat velit reiciendis? Consequatur, perferendis asperiores!</div></div>
    <div class="message"><div class="avatar">üë§</div><div class="bubble">Suggestions (5) Lorem ipsum, dolor sit amet consectetur adipisicing elit. Dignissimos a suscipit eveniet error deleniti, sequi accusantium commodi quidem cupiditate voluptatem quis laboriosam iste iusto quo aperiam unde illo ipsa quas?</div></div>
    <div class="message"><div class="avatar">üë§</div><div class="bubble">Suggestions (6) Lorem ipsum dolor sit amet consectetur, adipisicing elit. Mollitia officia ipsam enim ipsa quaerat dolore et vitae sunt nesciunt ducimus.</div></div>
    <div class="message"><div class="avatar">üë§</div><div class="bubble">Suggestions (7) Lorem ipsum dolor sit amet consectetur, adipisicing elit. Accusantium consequuntur tenetur, ex quidem sunt iste dolorum voluptatibus minus perferendis dignissimos. Iure, expedita mollitia? Esse maxime magnam tempora rem eligendi placeat, quas ducimus molestias, neque, non assumenda quisquam. Ab, amet maiores! Voluptates omnis adipisci perferendis eius culpa tenetur libero atque, eos quos nostrum quas quisquam ipsum cumque voluptatibus animi sapiente. Hic?</div></div>
    <div class="message"><div class="avatar">üë§</div><div class="bubble">Suggestions (8) Lorem ipsum, dolor sit amet consectetur adipisicing elit. Maiores, non?</div></div>
    <div class="message"><div class="avatar">üë§</div><div class="bubble">Suggestions (9) Lorem ipsum dolor, sit amet consectetur adipisicing elit. Explicabo accusantium veniam sunt dolore veritatis quod, nihil nostrum expedita alias voluptates unde?</div></div>
    <div class="message"><div class="avatar">üë§</div><div class="bubble">Suggestions (10) Lorem ipsum dolor sit amet consectetur adipisicing elit. Beatae, debitis.</div></div>
    <div class="message"><div class="avatar">üë§</div><div class="bubble">Suggestions (11) Lorem ipsum dolor sit amet consectetur adipisicing elit. Facilis, voluptates et? Dolores nam voluptatibus assumenda eaque minus, doloremque odit, nisi, quaerat modi reiciendis provident non impedit quis distinctio velit architecto quidem sequi ipsam illum ut. Dicta dolore ut eveniet corporis? Id culpa accusamus quo, provident aliquam deserunt voluptas exercitationem fugiat maxime mollitia recusandae magnam, eaque enim. Enim quod obcaecati doloribus quasi, natus numquam dolore corrupti? Maxime, sit nobis. Maiores, culpa!</div></div>
    <div class="message"><div class="avatar">üë§</div><div class="bubble">Suggestions (12) Lorem ipsum dolor sit, amet consectetur adipisicing elit. Reiciendis, aliquid?</div></div>
    <div class="message"><div class="avatar">üë§</div><div class="bubble">Suggestions (13) Lorem ipsum dolor sit amet consectetur adipisicing elit. Quis, necessitatibus?</div></div>
    <div class="message"><div class="avatar">üë§</div><div class="bubble">Suggestions (14) Lorem ipsum dolor sit amet consectetur, adipisicing elit. Necessitatibus porro natus eveniet et assumenda soluta dicta magnam sit reiciendis officiis quibusdam, ut repellat eos amet odit fugit vel nam quaerat vero? Alias magni ipsa optio aperiam dolor, dolore illum natus sequi reprehenderit velit similique. Tenetur.</div></div>
    <div class="message"><div class="avatar">üë§</div><div class="bubble">Suggestions (15) Lorem ipsum dolor sit amet, consectetur adipisicing elit. Temporibus, error.</div></div>
    <div class="message"><div class="avatar">üë§</div><div class="bubble">Suggestions (16) Lorem, ipsum dolor sit amet consectetur adipisicing elit. Corporis!</div></div>
    <div class="message"><div class="avatar">üë§</div><div class="bubble">Suggestions (17) Lorem ipsum, dolor sit amet consectetur adipisicing elit. Iure laborum molestias cum, nihil corrupti odit quo repellendus. Tenetur ex aspernatur impedit harum eligendi quis voluptate. Exercitationem beatae neque dolore doloremque.</div></div>
    <div class="message"><div class="avatar">üë§</div>
      <div class="voice" role="button" tabindex="0" data-src="voice3.mp3"
           onclick="playVoice(this)" onkeydown="handleKeyPress(event,this)">
        <span class="play-icon" aria-hidden="true"></span>
        <span class="label">Voice Suggestions (3)</span>
      </div>
      <audio id="voice3" src="voice3.mp3" preload="none"></audio>
    </div>
  </div>
</div>

<script>
  // Keep a reference to the currently playing audio so we can stop it
  let currentAudio = null;

  function showDescription() {
    alert("Event Description clicked!");
  }

  function showTotalSuggestions() {
    alert("Total Suggestions clicked!");
  }

  function openSuggestions(text) {
    alert("Text clicked: " + text);
  }
  function goToEventDescription(){
    window.location.href = "event_discription_sugg.html"; // link to your second interface page
  }

  function goBack(){
    window.location.href = "Suggestion_detail.html"; // link to your second interface page
  }

  // Play voice from a DOM element that contains data-src (robust and simple)
  function playVoice(el) {
    if (!el) return;
    // Determine source in this order: data-src -> matching audio sibling -> id-based audio element
    let src = el.dataset && el.dataset.src ? el.dataset.src : null;

    if (!src) {
      // try to find a sibling <audio> tag
      const audioEl = el.closest('.message')?.querySelector('audio');
      if (audioEl) src = audioEl.getAttribute('src') || audioEl.src;
    }

    if (!src) {
      alert('Audio file not found for this Suggestions.');
      return;
    }

    // If an audio is already playing, stop it (so only one plays at a time)
    if (currentAudio && !currentAudio.paused) {
      currentAudio.pause();
      currentAudio.currentTime = 0;
    }

    // Create a fresh Audio instance and play it
    currentAudio = new Audio(src);
    currentAudio.play().catch(err => {
      // common reasons: autoplay policy, network error
      console.error('playback error', err);
      alert('Unable to play audio. Check the file path or browser autoplay settings.');
    });
  }

  // accessibility: allow Enter / Space to trigger the same action
  function handleKeyPress(e, el) {
    if (e.key === 'Enter' || e.key === ' ') {
      e.preventDefault();
      playVoice(el);
    }
  }

  // Count total Suggestions dynamically and update tooltip
function updateSuggestionsTooltip() {
  const SuggestionsCount = document.querySelectorAll(".chat-box .message").length;
  const btn = document.getElementById("totalSuggestionsBtn");
  btn.title = `Total ${SuggestionsCount} Suggestions`; // hover message
}
updateSuggestionsTooltip(); // run once on load

</script>
</body>
</html>
